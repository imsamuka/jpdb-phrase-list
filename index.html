<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jpdb Phrase List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script> -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>

<body class="dark" x-data="{ reviews: {} }"
    x-init="reviews = JSON.parse(localStorage.getItem('reviews') || '{}') || {}">


    <div class="container mt-3">

        <div class="row row-cols-1 row-cols-md-2">

            <div class="col">

                <h2 class="mb-3 mt-4 text-center">Configuration</h2>

                <div class="input-group mb-3">
                    <label class="input-group-text" for="fileUpload">Upload Reviews</label>

                    <input class="form-control" id="fileUpload" type="file" accept=".json,application/json" @input="
                        const raw = await $event.target.files[0].text() || '{}'
                        const parsed = JSON.parse(raw)
                        if (parsed && Object.keys(parsed).length > 0) {
                            console.log('Updating stored \'reviews\'')
                            console.log(parsed)
                            localStorage.setItem('reviews', raw)
                            reviews = parsed
                        }
                    ">

                    <button class="btn btn-outline-danger btn-sm"
                        @click="reviews = {}; localStorage.removeItem('reviews')">Delete Reviews</button>
                </div>

                <div class="input-group mb-3">
                    <label for="min_grasp" class="input-group-text">Words Minimum Grasp Level</label>
                    <input id="min_grasp" type="number" class="form-control" value="70" min="10" max="90" step="10">
                    <span class="input-group-text">%</span>
                </div>

                <div class="input-group mb-3">
                    <label for="unknown_words" class="input-group-text">Unknown Words</label>
                    <input id="unknown_words" type="number" class="form-control" value="0" min="0">
                </div>

                <div class="search-bar">
                    <input type="text" class="form-control" placeholder="Show Phrases Containing...">
                </div>
            </div>

            <div class="col">

                <h2 class="mb-3 mt-4 text-center">Status</h2>

                <h3 class="text-center text-secondary">Work in Progress</h3>

            </div>
        </div>

        <div class="row">

            <h2 class="mb-3 mt-4 text-center">Available Phrases</h2>

            <div class="row row-cols-1 row-cols-md-3 g-2">

                <template x-for="rcard in reviews.cards_vocabulary_jp_en">
                    <div class="col">
                        <div class="card" x-data="{ spelling: false }">
                            <div class="card-body link-underline-opacity-0">
                                <ruby>
                                    <a class="card-text" x-text="rcard.spelling"
                                        :href="'https://jpdb.io/search?q=' + rcard.spelling"></a>
                                    <rp>(</rp>
                                    <rt x-show="spelling" x-text="rcard.reading"></rt>
                                    <rp>)</rp>
                                </ruby>

                                <button class="btn btn-secondary btn-sm" x-show="!spelling"
                                    @click="spelling = !spelling">Spelling</button>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </div>



</body>


</html>
